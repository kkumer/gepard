C     ****h* gepard/houches.F
C  FILE DESCRIPTION
C    Program for testing evolution
C
C    $Id$
C     *******

C     ****p* houches.F/HOUCHES
C  NAME
C    HOUCHES  --  Testing gepard routines
C            
C  DESCRIPTION
C     Calculates evolution of PDFs (defined
C     as in Les Houches accord) by using special
C     'EVOLQ' and 'EVOLG' schemes where C = (1, 0) and
C      (0, 1), respecively, to all orders.
C
C  CHILDREN
C     INIT, PARWAVF, AS2PF
C  SOURCE
C

      PROGRAM HOUCHES

      IMPLICIT NONE
      INTEGER K,  K1, QIND
      DOUBLE COMPLEX EPH, J, FPW
      DOUBLE PRECISION F2IMAG, RES, XG(4)
      DOUBLE PRECISION AS
      DOUBLE PRECISION LHXGLO(21), LHXGNLO(21)
      DOUBLE PRECISION LHXGNNLO(21), XIA(21)
      DOUBLE COMPLEX FCM(2)
#include "header.F"

      PROCESS = 'DIS'
      FFTYPE = 'SINGLET'

*  Values of Bjorken x

      DATA XIA / 1.D-7,  5.D-7,  1.D-6,  5.D-6,  1.D-5,  5.D-5,
     ,           1.D-4,  5.D-4,  1.D-3,  5.D-3,  1.D-2,  5.D-2,
     ,           1.D-1,  2.D-1,  3.D-1,  4.D-1,  5.D-1,  6.D-1,
     ,           7.D-1,  8.D-1,  9.D-1 /


*  Data produced by QCD-Pegasus using
*       0         IFAST
*       0         IVFNS
*       4         NFF
*       3         IMODEV
*      (P)        NPORD
*       1.0D0     FR2



*  LO  2->1E4 GeV^2
      DATA LHXGLO
     &/ 1.31624486D+03, 7.65356852D+02, 6.00076460D+02, 3.32192206D+02,
     &  2.54187389D+02, 1.31665799D+02, 9.73709003D+01, 4.57445357D+01,
     &  3.20780812D+01, 1.27460817D+01, 8.05462182D+00, 2.07812886D+00,
     &  8.87657279D-01, 2.52948026D-01, 8.26758116D-02, 2.67377160D-02,
     &  7.92403912D-03, 1.98822240D-03, 3.73111516D-04, 4.02605715D-05,
     &  1.09177297D-06 /

*  NLO  2->1E4 GeV^2
      DATA LHXGNLO
     &/ 1.06364785D+03, 6.42188643D+02, 5.11438949D+02, 2.93191056D+02,
     &  2.27608345D+02, 1.21736418D+02, 9.12151443D+01, 4.40949059D+01,
     &  3.12752322D+01, 1.27208599D+01, 8.10377560D+00, 2.11294045D+00,
     &  9.02814587D-01, 2.57020610D-01, 8.40469333D-02, 2.72514860D-02,
     &  8.12004980D-03, 2.05669454D-03, 3.92036708D-04, 4.34412655D-05,
     &  1.24278102D-06 /

*  NLO  2->1E2 GeV^2
*      DATA LHXGNLO
*     &/ 2.67215143E+02, 1.81874893E+02, 1.52885545E+02, 1.00010072E+02,
*     &  8.24448781E+01, 5.11541874E+01, 4.10478330E+01, 2.35836702E+01,
*     &  1.81494171E+01, 9.13143911E+00, 6.46100378E+00, 2.25918773E+00,
*     &  1.13207707E+00, 3.89931784E-01, 1.45211220E-01, 5.21256895E-02,
*     &  1.69086639E-02, 4.61840075E-03, 9.49414229E-04, 1.15976152E-04,
*     &  4.01889056E-06 /

*  NLO  2->10 GeV^2
*      DATA LHXGNLO
*     &/ 6.66733058E+01, 5.02857892E+01, 4.43037175E+01, 3.25600520E+01,
*     &  2.83227874E+01, 2.01068608E+01, 1.71839177E+01, 1.15984765E+01,
*     &  9.64207564E+00, 5.94723227E+00, 4.65691332E+00, 2.15876853E+00,
*     &  1.25771059E+00, 5.18356575E-01, 2.18579014E-01, 8.66571557E-02,
*     &  3.05558919E-02, 8.95310615E-03, 1.94833763E-03, 2.49013859E-04,
*     &  9.21731994E-06 /



*  NLO  2->2 GeV^2
*      DATA LHXGNLO
*     &/ 8.52018018E+00, 7.25355503E+00, 6.76778923E+00, 5.76157392E+00,
*     &  5.37560416E+00, 4.57555120E+00, 4.26807299E+00, 3.62631885E+00,
*     &  3.37502067E+00, 2.81622533E+00, 2.56227046E+00, 1.77488420E+00,
*     &  1.26375109E+00, 6.54328643E-01, 3.22275337E-01, 1.44876935E-01,
*     &  5.69379750E-02, 1.83203526E-02, 4.28100232E-03, 5.56275540E-04,
*     &  1.71800533E-05 /

*  NNLO  2->1E4 GeV^2
      DATA LHXGNNLO
     &/ 9.54709556E+02, 5.95693323E+02, 4.80160525E+02, 2.81829247E+02,
     &  2.20634768E+02, 1.19883898E+02, 9.03022290E+01, 4.40449553E+01,
     &  3.13173368E+01, 1.27754778E+01, 8.14112771E+00, 2.12248738E+00,
     &  9.06821207E-01, 2.58068662E-01, 8.43354051E-02, 2.73189452E-02,
     &  8.12879772E-03, 2.05460068E-03, 3.90354466E-04, 4.30180563E-05,
     &  1.21785544E-06 /

* Below are NNLO results obtained by Pegasus using old NNLO an. dims.

*  NNLO  2->1E4 GeV^2
*      DATA LHXGNNLO
*     &/ 9.69817205D+02, 6.02685026D+02, 4.85048535D+02, 2.83794151D+02,
*     &  2.21904017D+02, 1.20277255D+02, 9.05165376D+01, 4.40740409D+01,
*     &  3.13209650D+01, 1.27681601D+01, 8.13645285D+00, 2.12231055D+00,
*     &  9.06866640D-01, 2.58071662D-01, 8.43337809D-02, 2.73188374D-02,
*     &  8.12897137D-03, 2.05463393D-03, 3.90340474D-04, 4.30169609D-05,
*     &  1.21906487D-06 /

*  NNLO  2->1E2 GeV^2
*      DATA LHXGNNLO
*     &/ 2.12700286E+02, 1.55355923E+02, 1.33937129E+02, 9.19900090E+01,
*     &  7.71452109E+01, 4.94192478E+01, 4.00780523E+01, 2.34395981E+01,
*     &  1.81267188E+01, 9.17242051E+00, 6.49432066E+00, 2.27092705E+00,
*     &  1.13770326E+00, 3.91601155E-01, 1.45731441E-01, 5.22799142E-02,
*     &  1.69483134E-02, 4.62563381E-03, 9.49656931E-04, 1.15706807E-04,
*     &  3.99121301E-06 /

*  NNLO  2->10 GeV^2
*      DATA LHXGNNLO
*     &/ 4.20047504E+01, 3.65734296E+01, 3.38885558E+01, 2.74215798E+01,
*     &  2.46713932E+01, 1.86522441E+01, 1.62788918E+01, 1.13852508E+01,
*     &  9.55911800E+00, 5.96782478E+00, 4.68053435E+00, 2.17000703E+00,
*     &  1.26362026E+00, 5.20250157E-01, 2.19171455E-01, 8.68279757E-02,
*     &  3.06011319E-02, 8.96474914E-03, 1.95139066E-03, 2.49681740E-04,
*     &  9.28440374E-06 /


*  NNLO  2->2 GeV^2
*      DATA LHXGNNLO
*     &/ 8.52018018E+00, 7.25355503E+00, 6.76778923E+00, 5.76157392E+00,
*     &  5.37560416E+00, 4.57555120E+00, 4.26807299E+00, 3.62631885E+00,
*     &  3.37502067E+00, 2.81622533E+00, 2.56227046E+00, 1.77488420E+00,
*     &  1.26375109E+00, 6.54328643E-01, 3.22275337E-01, 1.44876935E-01,
*     &  5.69379750E-02, 1.83203526E-02, 4.28100232E-03, 5.56275540E-04,
*     &  1.71800533E-05 /


      CALL READPAR

*   Following artifical renorm. scheme has C = (0, 1) at
*   all orders, thus effectively putting F_2 -> Q_s^2 x g(x)

      WRITE (*,*) 'This test is presently broken!'
*   FIXME: understand how to change (old) PROCESS = 'EVOLG' into this:
      PROCESS = 'DVCSZG'
      

*   Parameters of Les Houches benchmark

      NF = 4
      Q02 = 2.0D0
      ANSATZ = 'HOUCHE'

      MU02 = 2.0D0
      ASP(0) = 0.35D0 / (2.0d0 * PI)
      ASP(1) = 0.35D0 / (2.0d0 * PI)
      ASP(2) = 0.35D0 / (2.0d0 * PI)

      Q2 = 1.0D4
      NQSDIS = 1
      QSDIS(1) = Q2




      OPEN (UNIT = 11, FILE = 'NLOACC.dat', STATUS = 'UNKNOWN') 
      OPEN (UNIT = 12, FILE = 'NNLOACC.dat', STATUS = 'UNKNOWN') 


      DO 210 SPEED = 1, 4
      WRITE (11, *) '# SPEED = ', SPEED
      WRITE (12, *) '# SPEED = ', SPEED
      WRITE (*,*) 'SPEED = ', SPEED

*  Gluon part - NLO evolution
      DO 35 K1 = 1, 21
        XI = XIA(K1)
        RES = 0.0D0
        P = 1
        CALL INIT
        CALL EVOLC(1,1)
        DEL2 = 0.0d0
        CALL GETMBGPD
        EPH = EXP ( DBLCMPLX(0.0d0, PHI) )

        MTIND = 0
        QIND = 1
        DO 30 K = 1, NPTS
        J = N(1,K) - 1
        FCM(1) = MBGPD(K, 1)
        FCM(2) = MBGPD(K, 2)
        FPW = CGRIDDIS(QIND,K,1) * FCM(1) + CGRIDDIS(QIND,K,2) * FCM(2)
        F2IMAG = IMAGPART(EPH * (1.0d0/XI)**(J-C) * FPW )
        RES = RES + WG(K)*F2IMAG
 30     CONTINUE

        XG(3) = (1.0d0/XI)**(C) * RES / 3.1415926535897932
        WRITE (11, 803) XI, ABS((XG(3)-LHXGNLO(K1))/LHXGNLO(K1))
*       WRITE (11, 803) XI, XG(3)
 35   CONTINUE

*  Gluon part - NNLO evolution
      DO 45 K1 = 1, 21
        XI = XIA(K1)
        RES = 0.0D0
        P = 2
        CALL INIT
        CALL EVOLC(1,1)
        CALL GETMBGPD
        EPH = EXP ( DBLCMPLX(0.0d0, PHI) )


        MTIND = 0
        QIND = 1
        DO 40 K = 1, NPTS
        J = N(1,K) - 1
        FCM(1) = MBGPD(K, 1)
        FCM(2) = MBGPD(K, 2)
        FPW = CGRIDDIS(QIND,K,1) * FCM(1) + CGRIDDIS(QIND,K,2) * FCM(2)
        F2IMAG = IMAGPART(EPH * (1.0d0/XI)**(J-C) * FPW )
        RES = RES + WG(K)*F2IMAG
 40     CONTINUE

        XG(4) = (1.0d0/XI)**(C) * RES / 3.1415926535897932
        WRITE (12, 803) XI, ABS((XG(4)-LHXGNNLO(K1))/LHXGNNLO(K1))
*       WRITE (12, 803) XI, XG(4)
 45   CONTINUE

      WRITE (11, *)
      WRITE (12, *)
 210  CONTINUE
      DO 300 P = 0, 2
      CALL AS2PF (AS, Q2, ASP(P), MU02)  
      WRITE (*,904) P, AS * 2.0D0 * PI
      IF (P .EQ. 0) THEN
        WRITE (*, *) "Pegasus   LO alpha_strong = 0.1175739961"
      ELSE IF (P .EQ. 1) THEN
        WRITE (*, *) "Pegasus  NLO alpha_strong = 0.1109018114"
      ELSE
        WRITE (*, *) "Pegasus NNLO alpha_strong = 0.1101410084"
      END IF
      WRITE (*, *)
 300  CONTINUE

 803  FORMAT (1X, E7.1, 8X, E20.9)
 904  FORMAT (1X, 'alpha_strong( P=', I1, ' ) =       ', F10.8)

      STOP
      END
C     ****
